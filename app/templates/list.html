<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  {%load static%}
  <title>Your Links â€” Shortly</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{%static 'css/list.css'%}">
  <link rel="stylesheet" href="{%static 'css/navbar.css'%}">
  <link rel="stylesheet" href="{%static 'css/footer.css'%}">
</head>
<body>
{%include 'partials/navbar.html'%}
<main class="page">

  <!-- HEADER -->
  <section class="page-header">
    <h1 class="gradient-text">Your Shortened Links</h1>
    <p class="subtitle">
      Manage, monitor, and track the performance of your shortened URLs.
    </p>
      
      <div class="search-wrapper">
            <button id="searchToggle" class="search-btn">
                ğŸ” Search
            </button>

            <form method="get" id="searchForm" class="search-form hidden">
                <label>
                    <input
                        type="text"
                        name="q"
                        placeholder="Search by title, short link or URLâ€¦"
                        value="{{ request.GET.q }}"
                        />
                </label>
            </form>
      </div>
  </section>

  <!-- STATS -->
  <section class="stats">
    <div class="stat-card">
      <span class="label">Total Links</span>
      <span class="value">{{total_urls}}</span>
    </div>
    <div class="stat-card">
      <span class="label">Active Links</span>
      <span class="value green">{{active_urls}}</span>
    </div>
    <div class="stat-card">
      <span class="label">Disabled Links</span>
      <span class="value red" style="color:red;">{{disabled_urls}}</span>
    </div>
    <div class="stat-card">
      <span class="label">Total Clicks</span>
      <span class="value">{{total_clicks}}</span>
    </div>
<a href="{%url 'home'%}">
    <div class="stat-card">
      <span class="label">Create new Short Link â• </span>
      <span class="value"></span>
    </div>
</a>
  </section>

  <table class="url-table">
    <thead>
      <tr>
        <th>Short Link</th>
        <th>Title</th>
        <th>Original URL</th>
        <th>Clicks</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      {% for url in urls %}
      <tr>

        <!-- Short link -->
        <td data-label="Short Link">
          <a href="{% url 'redirect' url.short_code %}">
            {{ url.short_code }}
          </a>
        </td>

        <!-- Title -->
        <td data-label="Title">{{ url.title }}</td>

        <!-- Original URL -->
        <td  data-label="Original URL">
          {{ url.original_url }}
        </td>

        <!-- Click count -->
        <td  data-label="Clicks">{{ url.click_count }}</td>

        <!-- Status pill -->
        <td data-label="Status">
          <span class="status {% if url.is_active %}active{% else %}disabled{% endif %}">
            {% if url.is_active %}Active{% else %}Disabled{% endif %}
          </span>
        </td>

        <!-- Actions -->
        <td  data-label="Actions">
          <!-- Toggle -->
          <span class="tooltip">
            <a href="{% url 'toggle' url.id %}"
               class="icon-btn {% if url.is_active %}active{% endif %}">
              â»
            </a>
            <span class="tooltip-text">Activate / Disable</span>
          </span>

          <!-- Edit -->
          <span class="tooltip">
            <a href="{% url 'update' url.id %}" class="icon-btn edit">
              ğŸ“
            </a>
            <span class="tooltip-text">Edit</span>
          </span>

          <!-- Delete -->
          <span class="tooltip">
            <a href="{% url 'delete' url.id %}" class="icon-btn delete">
              ğŸ—‘
            </a>
            <span class="tooltip-text">Delete</span>
          </span>

          <!-- Copy -->
          <span class="tooltip">
            <a class="icon-btn link"
               data-url="{{ request.scheme }}://{{ request.get_host }}/redirect/{{ url.short_code }}"
               onclick="copyToClipboard(this)">
              ğŸ”—
            </a>
            <span class="tooltip-text">Copy URL</span>
          </span>
        </td>

      </tr>
      {% endfor %}
    </tbody>
  </table>





 <div class="pagination">
  {% if urls.has_previous %}
    <a class="page-btn prev" href="?page={{ urls.previous_page_number }}">â† Previous</a>
  {% else %}
    <span class="page-btn disabled">â† Previous</span>
  {% endif %}

  <span class="page-info">
    Page {{ urls.number }} of {{ urls.paginator.num_pages }}
  </span>

  {% if urls.has_next %}
    <a class="page-btn next" href="?page={{ urls.next_page_number }}">Next â†’</a>
  {% else %}
    <span class="page-btn disabled">Next â†’</span>
  {% endif %}
</div>


  <!-- FOOTNOTE -->
  <section class="note">
    <p>
      Tip: Keep your links organized by monitoring inactive URLs and tracking click trends.
    </p>
  </section>

</main>
{%include 'partials/footer.html'%}
<script src="{%static 'js/list.js' %}"></script>
</body>
</html>
